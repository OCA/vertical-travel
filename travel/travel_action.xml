<?xml version="1.0" encoding="utf-8"?>
<openerp>
  <data noupdate="1">
    <record id="travel_travel_opened_server_action" model="ir.actions.server">
      <field name="name">Email alert when travel is send to the travel agency</field>
      <field name="model_id" ref="model_travel_travel" />
      <field name="state">email</field>
      <field name="sequence">5</field>
      <field name="email">object.responsible_emails</field>
      <field name="subject">Travel alert ([[object.name]])</field>
      <field name="message">Hello,

A new travel ([[object.name]]) has just been sent to the travel agency by [[object.user_id.name]].

Have a nice day!
      </field>
    </record>
    <record id="travel_travel_reserved_server_action" model="ir.actions.server">
      <field name="name">Email alert when travel is reserved</field>
      <field name="model_id" ref="model_travel_travel" />
      <field name="state">email</field>
      <field name="sequence">5</field>
      <field name="email">object.responsible_emails</field>
      <field name="subject">Travel alert ([[object.name]])</field>
      <field name="message">Hello,

The travel ([[object.name]]) has just been reserved.

Have a nice day!
      </field>
    </record>
  </data>

  <data>
    <record id="travel_travel_flag_opened_server_action" model="ir.actions.server">
      <field name="name">Flag travel when it's sent to the travel agency</field>
      <field name="model_id" ref="model_travel_travel" />
      <field name="state">code</field>
      <field name="sequence">10</field>
      <field name="condition">object.is_opened is False</field>
      <field name="code">object.write({'is_opened': True})</field>
    </record>
    <record id="travel_travel_opened_filter" model="ir.filters">
      <field name="name">Open</field>
      <field name="model_id">travel.travel</field>
      <field name="domain">[('state', '=', 'open'), ('is_opened', '=', False)]</field>
      <field name="user_id" eval="False"/>
    </record>
    <record id="rule_travel_travel_opened_action_rule" model="base.action.rule">
      <field name="name">Send an alert when travel is opened</field>
      <field name="model_id" ref="model_travel_travel"/>
      <field name="filter_id" ref="travel_travel_opened_filter" />
      <field name="server_action_ids" eval="[(6, 0, [ref('travel_travel_opened_server_action'), ref('travel_travel_flag_opened_server_action')])]"/>
    </record>
    <record id="travel_travel_flag_reserved_server_action" model="ir.actions.server">
      <field name="name">Flag travel when it's reserved</field>
      <field name="model_id" ref="model_travel_travel" />
      <field name="state">code</field>
      <field name="sequence">10</field>
      <field name="condition">object.is_reserved is False</field>
      <field name="code">object.write({'is_reserved': True})</field>
    </record>
    <record id="travel_travel_reserved_filter" model="ir.filters">
      <field name="name">Reserved</field>
      <field name="model_id">travel.travel</field>
      <field name="domain">[('state', '=', 'reserved'), ('is_reserved', '=', False)]</field>
      <field name="user_id" eval="False"/>
    </record>
    <record id="rule_travel_travel_reserved_action_rule" model="base.action.rule">
      <field name="name">Send an alert when travel is reserved</field>
      <field name="model_id" ref="model_travel_travel"/>
      <field name="filter_id" ref="travel_travel_reserved_filter" />
      <field name="server_action_ids" eval="[(6, 0, [ref('travel_travel_reserved_server_action'), ref('travel_travel_flag_reserved_server_action')])]"/>
    </record>
  </data>
</openerp>
